{"version":3,"file":"static/800.e52aa903.chunk.js","mappings":"oUAMO,MA8EMA,EAAa,EAAGC,cAC3B,MAQMC,EAAOD,EAAQE,KAAIC,IACvBA,EAAOC,aAAe,CAACD,EAAOC,aAAaC,KAAK,OAChDF,EAAOG,KAAO,CAACH,EAAOG,KAAKD,KAAK,OAEzBF,KAGT,OACE,SAACI,EAAAA,EAAKA,CACJC,MAAM,oBACNC,QAAS,CAAEC,QAAQ,EAAMC,QAAQ,GACjCC,QAnB2B,CAC7B,CAAEJ,MAAO,SAAUK,MAAO,UAC1B,CAAEL,MAAO,YAAaK,MAAO,aAC7B,CAAEL,MAAO,QAASK,MAAO,SACzB,CAAEL,MAAO,eAAgBK,MAAO,gBAChC,CAAEL,MAAO,OAAQK,MAAO,SAetBZ,KAAMA,G,EAKCa,EAA0B,KACrC,MAAMC,GAASC,EAAAA,EAAAA,QAAOC,EAAAA,eAChB,MAAEC,EAAK,QAAEC,EAAO,MAAEC,IAAUC,EAAAA,EAAAA,IAASC,UAEzC,MAAMC,QAAiBC,MAAM,GAAGT,EAAOU,UAAU,2FAC9CC,OAAMC,GAAKA,IACXC,MAAKC,GAAQA,IAChBC,QAAQC,IAAIR,GACPA,EAASS,GAGd,MAAMhC,QAAgBuB,EAASU,OAG/B,IAAIC,EAQAC,EAPJ,IACED,GAAaE,EAAAA,EAAAA,IAAMpC,EACrB,CAAE,MAEF,CACA8B,QAAQC,IAAIG,GAGZ,IACEC,EAAcE,KAAKD,MAAMF,EAAWjC,KAAK,mBAC3C,CAAE,MAEF,CAGA,OAFA6B,QAAQC,IAAII,GAELA,EAAYG,KAAK,GACvB,IAEH,OAAInB,GACK,SAACoB,EAAAA,EAAQA,CAAAA,GACPnB,GACF,SAACoB,EAAAA,EAAkBA,CAACpB,MAAOA,KAG7B,SAACrB,EAAAA,CAAWC,QAASkB,GAAS,I,ECxI1BuB,EAAqB,KAChC,UAACC,EAAAA,EAAIA,CAACC,QAAQ,O,WACZ,UAACC,EAAAA,EAAMA,CAACpC,MAAM,wBAAwBqC,SAAS,mB,WAC7C,SAACC,EAAAA,EAAWA,CAACC,MAAM,QAAQ7B,MAAM,YACjC,SAAC4B,EAAAA,EAAWA,CAACC,MAAM,YAAY7B,MAAM,cAEvC,UAAC8B,EAAAA,EAAOA,C,WACN,SAACC,EAAAA,EAAaA,CAACzC,MAAM,Y,UACnB,SAAC0C,EAAAA,EAAaA,C,SAAC,yBAEjB,SAACC,EAAAA,EAAIA,CAACC,WAAS,EAACC,QAAS,EAAGC,UAAU,S,UACpC,SAACH,EAAAA,EAAIA,CAACI,MAAI,E,UACR,SAACzC,EAAuBA,CAAAA,Y","sources":["webpack://plugin-changelog/./src/components/ChangelogFetchComponent/ChangelogFetchComponent.tsx","webpack://plugin-changelog/./src/components/ChangelogComponent/ChangelogComponent.tsx"],"sourcesContent":["import React from 'react';\nimport { Table, TableColumn, Progress, ResponseErrorPanel } from '@backstage/core-components';\nimport { useApi, configApiRef } from '@backstage/core-plugin-api';\nimport useAsync from 'react-use/lib/useAsync';\nimport { parse } from 'yaml';\n\nexport const exampleChanges = {\n  \"results\": [\n    {\n      \"commit\": \"cf76ba0c6762fe88978e6f13baba0f66d1bfe4a2\",\n      \"merged_at\": \"2024-10-14T12:54:58.356Z\",\n      \"change_types\": [\n        \"progressive-delivery\",\n        \"saas-file-promotion\"\n      ],\n      \"error\": false,\n      \"apps\": [\n        \"osd-fleet-manager\"\n      ]\n    },\n    {\n      \"commit\": \"4b2af42ddd6224dbadcb5ee7241f1cc383048edc\",\n      \"merged_at\": \"2024-10-14T12:48:32.806Z\",\n      \"change_types\": [\n        \"resource-rds-defaults-updates\",\n        \"resource-updates\",\n        \"namespace-external-resources-updates\"\n      ],\n      \"error\": false,\n      \"apps\": [\n        \"Glitchtip\"\n      ]\n    },\n    {\n      \"commit\": \"e0e8a459c47ff183b10cea9f5033231abd401c56\",\n      \"merged_at\": \"2024-10-14T12:45:27.021Z\",\n      \"change_types\": [\n        \"saas-file-promotion\"\n      ],\n      \"error\": false,\n      \"apps\": [\n        \"osd-fleet-manager\"\n      ]\n    },\n    {\n      \"commit\": \"fdbb5159b5e71d5d1ed2a3798d01dbd285a96108\",\n      \"merged_at\": \"2024-10-14T12:41:43.941Z\",\n      \"change_types\": [\n        \"resource-rds-defaults-updates\",\n        \"resource-updates\",\n        \"namespace-external-resources-updates\"\n      ],\n      \"error\": false,\n      \"apps\": [\n        \"Glitchtip\"\n      ]\n    },\n    {\n      \"commit\": \"364a564a14a7e2c8233ef40d69017597248d140e\",\n      \"merged_at\": \"2024-10-14T12:37:49.661Z\",\n      \"change_types\": [\n        \"progressive-delivery\",\n        \"saas-file-promotion\"\n      ],\n      \"error\": false,\n      \"apps\": [\n        \"assisted-installer\"\n      ]\n    }\n  ]\n}\n\ntype Change = {\n  commit: string;\n  merged_at: string; // TODO: Timezone\n  change_types: string[];\n  error: boolean;\n  apps: string[];\n}\n\ntype DenseTableProps = {\n  changes: Change[];\n};\n\nexport const DenseTable = ({ changes }: DenseTableProps) => {\n  const columns: TableColumn[] = [\n    { title: 'Commit', field: 'commit' },\n    { title: 'Merged At', field: 'merged_at' },\n    { title: 'Error', field: 'error' },\n    { title: 'Change Types', field: 'change_types' },\n    { title: 'Apps', field: 'apps' },\n  ];\n\n  const data = changes.map(change => {\n    change.change_types = [change.change_types.join(\", \")];\n    change.apps = [change.apps.join(\", \")];\n\n    return change;\n  })\n\n  return (\n    <Table\n      title=\"Example Changelog\"\n      options={{ search: true, paging: true }}\n      columns={columns}\n      data={data}\n    />\n  );\n};\n\nexport const ChangelogFetchComponent = () => {\n  const config = useApi(configApiRef);\n  const { value, loading, error } = useAsync(async (): Promise<Change[]> => {\n    // TODO: fetch\n    const response = await fetch(`${config.getString('backend.baseUrl')}/api/proxy/inscope-resources/resources/yaml/configmap-change-log.yaml`)\n      .catch(e => e)\n      .then(resp => resp);\n    console.log(response);\n    if (!response.ok) {\n      // TODO: Return error\n    }\n    const changes = await response.text();\n\n\n    let config_map;\n    try {\n      config_map = parse(changes);\n    } catch {\n      // TODO: Return error\n    }\n    console.log(config_map);\n\n    let change_data;\n    try {\n      change_data = JSON.parse(config_map.data[\"change-log.json\"]);\n    } catch {\n      // TODO: Return error\n    }\n    console.log(change_data);\n\n    return change_data.items;\n  }, []);\n\n  if (loading) {\n    return <Progress />;\n  } else if (error) {\n    return <ResponseErrorPanel error={error} />;\n  }\n\n  return <DenseTable changes={value || []} />;\n};\n","import React from 'react';\nimport { Grid } from '@material-ui/core';\n\nimport {\n  Header,\n  Page,\n  Content,\n  ContentHeader,\n  HeaderLabel,\n  SupportButton,\n} from '@backstage/core-components';\nimport { ChangelogFetchComponent } from '../ChangelogFetchComponent';\n\nexport const ChangelogComponent = () => (\n  <Page themeId=\"tool\">\n    <Header title=\"Welcome to changelog!\" subtitle=\"A log of changes\">\n      <HeaderLabel label=\"Owner\" value=\"Team X\" />\n      <HeaderLabel label=\"Lifecycle\" value=\"Alpha\" />\n    </Header>\n    <Content>\n      <ContentHeader title=\"Changelog\">\n        <SupportButton>A log of changes.</SupportButton>\n      </ContentHeader>\n      <Grid container spacing={3} direction=\"column\">\n        <Grid item>\n          <ChangelogFetchComponent />\n        </Grid>\n      </Grid>\n    </Content>\n  </Page>\n);\n        // <Grid item>\n        //   <InfoCard title=\"Information card\">\n        //     <Typography variant=\"body1\">\n        //       All content should be wrapped in a card like this.\n        //     </Typography>\n        //   </InfoCard>\n        // </Grid>\n        // <Grid item>\n        //   <ExampleFetchComponent />\n        // </Grid>\n"],"names":["DenseTable","changes","data","map","change","change_types","join","apps","Table","title","options","search","paging","columns","field","ChangelogFetchComponent","config","useApi","configApiRef","value","loading","error","useAsync","async","response","fetch","getString","catch","e","then","resp","console","log","ok","text","config_map","change_data","parse","JSON","items","Progress","ResponseErrorPanel","ChangelogComponent","Page","themeId","Header","subtitle","HeaderLabel","label","Content","ContentHeader","SupportButton","Grid","container","spacing","direction","item"],"sourceRoot":""}